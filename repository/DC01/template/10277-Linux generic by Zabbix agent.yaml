zabbix_export:
  version: '6.0'
  date: '2024-08-25T12:07:48Z'
  groups:
    - uuid: 57b7ae836ca64446ba2c296389c009b7
      name: Templates/Modules
  templates:
    - uuid: 38f973ee1556494fadeacb2f6b1ec987
      template: 'Linux generic by Zabbix agent'
      name: 'Linux generic by Zabbix agent'
      description: 'Generated by official Zabbix template tool "Templator"'
      groups:
        - name: Templates/Modules
      items:
        - uuid: 5dc4ebda1b9244e7a9f901209b78570f
          name: 'Linux: Maximum number of open file descriptors'
          key: kernel.maxfiles
          delay: 1h
          history: 7d
          description: 'It could be increased by using `sysctl` utility or modifying the file `/etc/sysctl.conf`.'
          preprocessing:
            - type: DISCARD_UNCHANGED_HEARTBEAT
              parameters:
                - 1d
          tags:
            - tag: component
              value: system
          triggers:
            - uuid: abf2e035f1e54971a0795152f922271b
              expression: 'last(/Linux generic by Zabbix agent/kernel.maxfiles)<{$KERNEL.MAXFILES.MIN}'
              name: 'Linux: Configured max number of open filedescriptors is too low'
              event_name: 'Linux: Configured max number of open filedescriptors is too low (< {$KERNEL.MAXFILES.MIN})'
              priority: INFO
              tags:
                - tag: scope
                  value: performance
        - uuid: a82525acd1bd4039860ad2d750476760
          name: 'Linux: Maximum number of processes'
          key: kernel.maxproc
          delay: 1h
          history: 7d
          description: 'It could be increased by using `sysctl` utility or modifying the file `/etc/sysctl.conf`.'
          preprocessing:
            - type: DISCARD_UNCHANGED_HEARTBEAT
              parameters:
                - 1d
          tags:
            - tag: component
              value: system
          triggers:
            - uuid: 079c2be2b0a44965a8e83cedba222b8d
              expression: 'last(/Linux generic by Zabbix agent/kernel.maxproc)<{$KERNEL.MAXPROC.MIN}'
              name: 'Linux: Configured max number of processes is too low'
              event_name: 'Linux: Configured max number of processes is too low (< {$KERNEL.MAXPROC.MIN})'
              priority: INFO
              dependencies:
                - name: 'Linux: Getting closer to process limit'
                  expression: 'last(/Linux generic by Zabbix agent/proc.num)/last(/Linux generic by Zabbix agent/kernel.maxproc)*100>80'
              tags:
                - tag: scope
                  value: performance
        - uuid: 0207b131fa26435ba6b5979c46719bc8
          name: 'Linux: Number of processes'
          key: proc.num
          history: 7d
          tags:
            - tag: component
              value: system
        - uuid: fa98827fe6474bf692d6aba3273836f7
          name: 'Linux: Number of running processes'
          key: 'proc.num[,,run]'
          history: 7d
          tags:
            - tag: component
              value: system
        - uuid: 48c251895f234f4595c4133015c27a18
          name: 'Linux: System boot time'
          key: system.boottime
          delay: 15m
          history: 7d
          units: unixtime
          preprocessing:
            - type: DISCARD_UNCHANGED_HEARTBEAT
              parameters:
                - 1h
          tags:
            - tag: component
              value: system
        - uuid: f744b8e0be46431e8088803b3a1b210d
          name: 'Linux: System name'
          key: system.hostname
          delay: 1h
          history: 7d
          trends: '0'
          value_type: CHAR
          description: 'The host name of the system.'
          inventory_link: NAME
          preprocessing:
            - type: DISCARD_UNCHANGED_HEARTBEAT
              parameters:
                - 12h
          tags:
            - tag: component
              value: system
          triggers:
            - uuid: eda29f0c8c55495ab93820caa26338bf
              expression: 'change(/Linux generic by Zabbix agent/system.hostname) and length(last(/Linux generic by Zabbix agent/system.hostname))>0'
              name: 'Linux: System name has changed'
              event_name: 'Linux: System name has changed (new name: {ITEM.VALUE})'
              priority: INFO
              description: 'The name of the system has changed. Acknowledge to close the problem manually.'
              manual_close: 'YES'
              tags:
                - tag: scope
                  value: notice
                - tag: scope
                  value: security
        - uuid: ac41daaa287944f3b0429c6fb2bca09c
          name: 'Linux: System local time'
          key: system.localtime
          history: 7d
          units: unixtime
          description: 'The local system time of the host.'
          tags:
            - tag: component
              value: system
          triggers:
            - uuid: cffb7209ce2a45bd868ac41c0680be56
              expression: 'fuzzytime(/Linux generic by Zabbix agent/system.localtime,{$SYSTEM.FUZZYTIME.MAX})=0'
              recovery_mode: RECOVERY_EXPRESSION
              recovery_expression: 'fuzzytime(/Linux generic by Zabbix agent/system.localtime,{$SYSTEM.FUZZYTIME.MIN})=1'
              name: 'Linux: System time is out of sync'
              event_name: 'Linux: System time is out of sync (diff with Zabbix server > {$SYSTEM.FUZZYTIME.MAX})'
              priority: WARNING
              description: 'The host''s system time is different from Zabbix server time.'
              manual_close: 'YES'
              tags:
                - tag: scope
                  value: availability
                - tag: scope
                  value: performance
        - uuid: 2e6e1ac8eb724a47b6c50b6c352ee3f7
          name: 'Linux: Operating system architecture'
          key: system.sw.arch
          delay: 1h
          history: 7d
          trends: '0'
          value_type: CHAR
          description: 'The architecture of the operating system.'
          preprocessing:
            - type: DISCARD_UNCHANGED_HEARTBEAT
              parameters:
                - 1d
          tags:
            - tag: component
              value: os
        - uuid: a40ad2e2bda3453b873d634e6a003dc2
          name: 'Linux: Operating system'
          key: system.sw.os
          delay: 1h
          history: 7d
          trends: '0'
          value_type: CHAR
          inventory_link: OS
          preprocessing:
            - type: DISCARD_UNCHANGED_HEARTBEAT
              parameters:
                - 1d
          tags:
            - tag: component
              value: os
          triggers:
            - uuid: 2f043de71d2940d184aa02200e33c28a
              expression: 'change(/Linux generic by Zabbix agent/system.sw.os) and length(last(/Linux generic by Zabbix agent/system.sw.os))>0'
              name: 'Linux: Operating system description has changed'
              priority: INFO
              description: 'The description of the operating system has changed. Possible reasons are that the system has been updated or replaced. Acknowledge to close the problem manually.'
              manual_close: 'YES'
              dependencies:
                - name: 'Linux: System name has changed'
                  expression: 'change(/Linux generic by Zabbix agent/system.hostname) and length(last(/Linux generic by Zabbix agent/system.hostname))>0'
              tags:
                - tag: scope
                  value: notice
        - uuid: 1097f843e7324a1fa0508544ddddd556
          name: 'Linux: Software installed'
          key: system.sw.packages
          delay: 1h
          history: 7d
          trends: '0'
          value_type: TEXT
          preprocessing:
            - type: DISCARD_UNCHANGED_HEARTBEAT
              parameters:
                - 1d
          tags:
            - tag: component
              value: os
        - uuid: b3a8feced15d4a09a8a2d8d1d8c9a546
          name: 'Linux: System description'
          key: system.uname
          delay: 15m
          history: 7d
          trends: '0'
          value_type: CHAR
          description: 'The information as normally returned by `uname -a`.'
          preprocessing:
            - type: DISCARD_UNCHANGED_HEARTBEAT
              parameters:
                - 12h
          tags:
            - tag: component
              value: system
        - uuid: 0a49428e394c4431bf97aa8787637bff
          name: 'Linux: System uptime'
          key: system.uptime
          delay: 30s
          history: 7d
          trends: '0'
          units: uptime
          description: 'The system uptime expressed in the following format: "N days, hh:mm:ss".'
          tags:
            - tag: component
              value: system
          triggers:
            - uuid: 2b612f4d65f4444c8a0609362c48463b
              expression: 'last(/Linux generic by Zabbix agent/system.uptime)<10m'
              name: 'Linux: {HOST.NAME} has been restarted'
              event_name: 'Linux: {HOST.NAME} has been restarted (uptime < 10m)'
              priority: WARNING
              description: 'The host uptime is less than 10 minutes.'
              manual_close: 'YES'
              tags:
                - tag: scope
                  value: notice
        - uuid: c595adf482c04553a2477bc1d929bc8d
          name: 'Linux: Number of logged in users'
          key: system.users.num
          history: 7d
          description: 'The number of users who are currently logged in.'
          tags:
            - tag: component
              value: environment
        - uuid: a10cff7883a4433bb744ebc2264fa13d
          name: 'Linux: Checksum of /etc/passwd'
          key: 'vfs.file.cksum[/etc/passwd,sha256]'
          delay: 15m
          history: 7d
          trends: '0'
          value_type: CHAR
          preprocessing:
            - type: DISCARD_UNCHANGED_HEARTBEAT
              parameters:
                - 1h
          tags:
            - tag: component
              value: security
          triggers:
            - uuid: a07bba3d320c4979b68ac0bbfad900dc
              expression: 'last(/Linux generic by Zabbix agent/vfs.file.cksum[/etc/passwd,sha256],#1)<>last(/Linux generic by Zabbix agent/vfs.file.cksum[/etc/passwd,sha256],#2)'
              name: 'Linux: /etc/passwd has been changed'
              priority: INFO
              manual_close: 'YES'
              dependencies:
                - name: 'Linux: Operating system description has changed'
                  expression: 'change(/Linux generic by Zabbix agent/system.sw.os) and length(last(/Linux generic by Zabbix agent/system.sw.os))>0'
                - name: 'Linux: System name has changed'
                  expression: 'change(/Linux generic by Zabbix agent/system.hostname) and length(last(/Linux generic by Zabbix agent/system.hostname))>0'
              tags:
                - tag: scope
                  value: security
      macros:
        - macro: '{$KERNEL.MAXFILES.MIN}'
          value: '256'
        - macro: '{$KERNEL.MAXPROC.MIN}'
          value: '1024'
        - macro: '{$SYSTEM.FUZZYTIME.MAX}'
          value: 60s
          description: 'The upper threshold for difference of system time.'
        - macro: '{$SYSTEM.FUZZYTIME.MIN}'
          value: 10s
          description: 'The lower threshold for difference of system time. Used in recovery expression to avoid trigger flapping.'
      dashboards:
        - uuid: a1f6a4775d2c4488a4e90d9b0ad143b0
          name: Processes
          pages:
            - name: Overview
              widgets:
                - type: GRAPH_CLASSIC
                  width: '24'
                  height: '5'
                  fields:
                    - type: GRAPH
                      name: graphid
                      value:
                        host: 'Linux generic by Zabbix agent'
                        name: 'Linux: Processes'
  triggers:
    - uuid: 613c30a98cf044b1b46a3d1d50f90eb8
      expression: 'last(/Linux generic by Zabbix agent/proc.num)/last(/Linux generic by Zabbix agent/kernel.maxproc)*100>80'
      name: 'Linux: Getting closer to process limit'
      event_name: 'Linux: Getting closer to process limit (over 80% used)'
      opdata: '{ITEM.LASTVALUE1} active, {ITEM.LASTVALUE2} limit.'
      priority: WARNING
      tags:
        - tag: scope
          value: performance
  graphs:
    - uuid: 644864fece6e4c0c9484c57e24808691
      name: 'Linux: Processes'
      graph_items:
        - color: 199C0D
          item:
            host: 'Linux generic by Zabbix agent'
            key: proc.num
        - sortorder: '1'
          color: F63100
          item:
            host: 'Linux generic by Zabbix agent'
            key: 'proc.num[,,run]'
