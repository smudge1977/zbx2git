zabbix_export:
  version: '6.0'
  date: '2024-08-25T12:38:06Z'
  groups:
    - uuid: a571c0d144b14fd4a87a9d9b2aa9fcd6
      name: Templates/Applications
  templates:
    - uuid: 5899b2f0aced4085b5ac25d0461b3425
      template: 'VMware Hypervisor'
      name: 'VMware Hypervisor'
      description: 'Generated by official Zabbix template tool "Templator"'
      groups:
        - name: Templates/Applications
      items:
        - uuid: 3010cb082f23478b858912f944347530
          name: 'VMware: Hypervisor ping'
          type: SIMPLE
          key: 'icmpping[]'
          history: 7d
          description: 'Checks if the hypervisor is running and accepting ICMP pings.'
          valuemap:
            name: 'Service state'
          preprocessing:
            - type: DISCARD_UNCHANGED_HEARTBEAT
              parameters:
                - 10m
          tags:
            - tag: component
              value: application
            - tag: component
              value: health
          triggers:
            - uuid: ab84a61566a5402db59efd40d20714a5
              expression: 'last(/VMware Hypervisor/icmpping[])=0'
              name: 'VMware: Hypervisor is down'
              priority: AVERAGE
              description: 'The service is unavailable or does not accept ICMP ping.'
              manual_close: 'YES'
              tags:
                - tag: scope
                  value: availability
        - uuid: af4d0877fda84753816c817ad76162f1
          name: 'VMware: Cluster name'
          type: SIMPLE
          key: 'vmware.hv.cluster.name[{$VMWARE.URL},{$VMWARE.HV.UUID}]'
          delay: 1h
          history: 7d
          trends: '0'
          value_type: CHAR
          username: '{$VMWARE.USERNAME}'
          password: '{$VMWARE.PASSWORD}'
          description: 'Cluster name of the guest VM.'
          preprocessing:
            - type: DISCARD_UNCHANGED_HEARTBEAT
              parameters:
                - 1d
          tags:
            - tag: component
              value: cluster
        - uuid: c4ebd62118464e7a8d1945f80d70f8ae
          name: 'VMware: CPU usage in percents'
          type: SIMPLE
          key: 'vmware.hv.cpu.usage.perf[{$VMWARE.URL},{$VMWARE.HV.UUID}]'
          history: 7d
          value_type: FLOAT
          units: '%'
          username: '{$VMWARE.USERNAME}'
          password: '{$VMWARE.PASSWORD}'
          description: 'CPU usage as a percentage during the interval.'
          tags:
            - tag: component
              value: cpu
        - uuid: 1bff6fbd300d4455a787a273d957bba3
          name: 'VMware: CPU usage'
          type: SIMPLE
          key: 'vmware.hv.cpu.usage[{$VMWARE.URL},{$VMWARE.HV.UUID}]'
          history: 7d
          units: Hz
          username: '{$VMWARE.USERNAME}'
          password: '{$VMWARE.PASSWORD}'
          description: 'Aggregated CPU usage across all cores on the host in Hz. This is only available if the host is connected.'
          tags:
            - tag: component
              value: cpu
        - uuid: aad168c33cd14f76aa14ab5ca26498ec
          name: 'VMware: CPU utilization'
          type: SIMPLE
          key: 'vmware.hv.cpu.utilization[{$VMWARE.URL},{$VMWARE.HV.UUID}]'
          history: 7d
          value_type: FLOAT
          units: '%'
          username: '{$VMWARE.USERNAME}'
          password: '{$VMWARE.PASSWORD}'
          description: 'CPU usage as a percentage during the interval depends on power management or HT.'
          tags:
            - tag: component
              value: cpu
        - uuid: e4d27d7f9b9048d4ae6c60cbdd6c0091
          name: 'VMware: Datacenter name'
          type: SIMPLE
          key: 'vmware.hv.datacenter.name[{$VMWARE.URL},{$VMWARE.HV.UUID}]'
          delay: 1h
          history: 7d
          trends: '0'
          value_type: CHAR
          username: '{$VMWARE.USERNAME}'
          password: '{$VMWARE.PASSWORD}'
          description: 'Datacenter name of the hypervisor.'
          preprocessing:
            - type: DISCARD_UNCHANGED_HEARTBEAT
              parameters:
                - 1d
          tags:
            - tag: component
              value: datacenter
        - uuid: 5c29837f75f04d7f9a5786691b3dd991
          name: 'VMware: Full name'
          type: SIMPLE
          key: 'vmware.hv.fullname[{$VMWARE.URL},{$VMWARE.HV.UUID}]'
          delay: 1h
          history: 7d
          trends: '0'
          value_type: CHAR
          username: '{$VMWARE.USERNAME}'
          password: '{$VMWARE.PASSWORD}'
          description: 'The complete product name, including the version information.'
          preprocessing:
            - type: DISCARD_UNCHANGED_HEARTBEAT
              parameters:
                - 1d
          tags:
            - tag: component
              value: system
        - uuid: ad0053d57b834e6a9776c08e1c455d55
          name: 'VMware: CPU frequency'
          type: SIMPLE
          key: 'vmware.hv.hw.cpu.freq[{$VMWARE.URL},{$VMWARE.HV.UUID}]'
          delay: 1h
          history: 7d
          units: Hz
          username: '{$VMWARE.USERNAME}'
          password: '{$VMWARE.PASSWORD}'
          description: 'The speed of the CPU cores. This is an average value if there are multiple speeds. The product of CPU frequency and number of cores is approximately equal to the sum of the MHz for all the individual cores on the host.'
          tags:
            - tag: component
              value: cpu
        - uuid: 3f0c35fcef9e4699ac5a1c51d80f8da4
          name: 'VMware: CPU model'
          type: SIMPLE
          key: 'vmware.hv.hw.cpu.model[{$VMWARE.URL},{$VMWARE.HV.UUID}]'
          delay: 1h
          history: 7d
          trends: '0'
          value_type: CHAR
          username: '{$VMWARE.USERNAME}'
          password: '{$VMWARE.PASSWORD}'
          description: 'The CPU model.'
          tags:
            - tag: component
              value: cpu
        - uuid: c99a5bf2e3904f97b3d361ca20af7883
          name: 'VMware: CPU cores'
          type: SIMPLE
          key: 'vmware.hv.hw.cpu.num[{$VMWARE.URL},{$VMWARE.HV.UUID}]'
          delay: 1h
          history: 7d
          username: '{$VMWARE.USERNAME}'
          password: '{$VMWARE.PASSWORD}'
          description: 'Number of physical CPU cores on the host. Physical CPU cores are the processors contained by a CPU package.'
          preprocessing:
            - type: DISCARD_UNCHANGED_HEARTBEAT
              parameters:
                - 1d
          tags:
            - tag: component
              value: cpu
        - uuid: 89cb0a4809e7454a862f398a0e9d6bed
          name: 'VMware: CPU threads'
          type: SIMPLE
          key: 'vmware.hv.hw.cpu.threads[{$VMWARE.URL},{$VMWARE.HV.UUID}]'
          delay: 1h
          history: 7d
          username: '{$VMWARE.USERNAME}'
          password: '{$VMWARE.PASSWORD}'
          description: 'Number of physical CPU threads on the host.'
          tags:
            - tag: component
              value: cpu
        - uuid: ce89c38e6e5d4338a30ee150be1b2b67
          name: 'VMware: Total memory'
          type: SIMPLE
          key: 'vmware.hv.hw.memory[{$VMWARE.URL},{$VMWARE.HV.UUID}]'
          delay: 1h
          history: 7d
          units: B
          username: '{$VMWARE.USERNAME}'
          password: '{$VMWARE.PASSWORD}'
          description: 'The physical memory size.'
          tags:
            - tag: component
              value: memory
        - uuid: 7ed7ac26da384bcda976badf24ebbec1
          name: 'VMware: Model'
          type: SIMPLE
          key: 'vmware.hv.hw.model[{$VMWARE.URL},{$VMWARE.HV.UUID}]'
          delay: 1h
          history: 7d
          trends: '0'
          value_type: CHAR
          username: '{$VMWARE.USERNAME}'
          password: '{$VMWARE.PASSWORD}'
          description: 'The system model identification.'
          tags:
            - tag: component
              value: system
        - uuid: 6c4aab55b3e640779a25ac90b9ca2a43
          name: 'VMware: Bios UUID'
          type: SIMPLE
          key: 'vmware.hv.hw.uuid[{$VMWARE.URL},{$VMWARE.HV.UUID}]'
          delay: 1h
          history: 7d
          trends: '0'
          value_type: CHAR
          username: '{$VMWARE.USERNAME}'
          password: '{$VMWARE.PASSWORD}'
          description: 'The hardware BIOS identification.'
          tags:
            - tag: component
              value: system
        - uuid: aec06090d16d4bdd8ed3494b448f19d8
          name: 'VMware: Vendor'
          type: SIMPLE
          key: 'vmware.hv.hw.vendor[{$VMWARE.URL},{$VMWARE.HV.UUID}]'
          delay: 1h
          history: 7d
          trends: '0'
          value_type: CHAR
          username: '{$VMWARE.USERNAME}'
          password: '{$VMWARE.PASSWORD}'
          description: 'The hardware vendor identification.'
          tags:
            - tag: component
              value: system
        - uuid: 21020a79436a49c38caf8941f6b68da3
          name: 'VMware: Ballooned memory'
          type: SIMPLE
          key: 'vmware.hv.memory.size.ballooned[{$VMWARE.URL},{$VMWARE.HV.UUID}]'
          history: 7d
          units: B
          username: '{$VMWARE.USERNAME}'
          password: '{$VMWARE.PASSWORD}'
          description: 'The amount of guest physical memory that is currently reclaimed through the balloon driver. Sum of all guest VMs.'
          tags:
            - tag: component
              value: memory
        - uuid: 93d680d6886d446badbbe995ddd9ba9c
          name: 'VMware: Used memory'
          type: SIMPLE
          key: 'vmware.hv.memory.used[{$VMWARE.URL},{$VMWARE.HV.UUID}]'
          history: 7d
          units: B
          username: '{$VMWARE.USERNAME}'
          password: '{$VMWARE.PASSWORD}'
          description: 'Physical memory usage on the host.'
          tags:
            - tag: component
              value: memory
        - uuid: 33f78ab6ee6c4e7585a83a60cdecab6f
          name: 'VMware: Number of bytes received'
          type: SIMPLE
          key: 'vmware.hv.network.in[{$VMWARE.URL},{$VMWARE.HV.UUID},bps]'
          history: 7d
          units: Bps
          username: '{$VMWARE.USERNAME}'
          password: '{$VMWARE.PASSWORD}'
          description: 'VMware hypervisor network input statistics (bytes per second).'
          tags:
            - tag: component
              value: network
        - uuid: b013afcba08b47f4a5b590a59f464a58
          name: 'VMware: Number of bytes transmitted'
          type: SIMPLE
          key: 'vmware.hv.network.out[{$VMWARE.URL},{$VMWARE.HV.UUID},bps]'
          history: 7d
          units: Bps
          username: '{$VMWARE.USERNAME}'
          password: '{$VMWARE.PASSWORD}'
          description: 'VMware hypervisor network output statistics (bytes per second).'
          tags:
            - tag: component
              value: network
        - uuid: e4116d7c7e234c5ebd5784f42ade1f2e
          name: 'VMware: Power usage maximum allowed'
          type: SIMPLE
          key: 'vmware.hv.power[{$VMWARE.URL},{$VMWARE.HV.UUID},max]'
          history: 7d
          units: '!W'
          username: '{$VMWARE.USERNAME}'
          password: '{$VMWARE.PASSWORD}'
          description: 'Maximum allowed power usage.'
          preprocessing:
            - type: DISCARD_UNCHANGED_HEARTBEAT
              parameters:
                - 6h
          tags:
            - tag: component
              value: power
        - uuid: 179a981cf30f4f77869e3b50dc2bc333
          name: 'VMware: Power usage'
          type: SIMPLE
          key: 'vmware.hv.power[{$VMWARE.URL},{$VMWARE.HV.UUID}]'
          history: 7d
          units: '!W'
          username: '{$VMWARE.USERNAME}'
          password: '{$VMWARE.PASSWORD}'
          description: 'Current power usage.'
          tags:
            - tag: component
              value: power
        - uuid: 3c9d6ffb53624758ad888bf70f69218c
          name: 'VMware: Get sensors'
          type: SIMPLE
          key: 'vmware.hv.sensors.get[{$VMWARE.URL},{$VMWARE.HV.UUID}]'
          history: '0'
          trends: '0'
          value_type: TEXT
          username: '{$VMWARE.USERNAME}'
          password: '{$VMWARE.PASSWORD}'
          description: 'Master item for sensors data.'
          tags:
            - tag: component
              value: raw
        - uuid: 0cec294521314c5482233b5b96e90c8d
          name: 'VMware: Overall status'
          type: SIMPLE
          key: 'vmware.hv.status[{$VMWARE.URL},{$VMWARE.HV.UUID}]'
          history: 7d
          username: '{$VMWARE.USERNAME}'
          password: '{$VMWARE.PASSWORD}'
          description: 'The overall alarm status of the host: gray - unknown, green - ok, red - it has a problem, yellow - it might have a problem.'
          valuemap:
            name: 'VMware status'
          tags:
            - tag: component
              value: health
          triggers:
            - uuid: 378511e0f1794874a68aef1b43561ee5
              expression: 'last(/VMware Hypervisor/vmware.hv.status[{$VMWARE.URL},{$VMWARE.HV.UUID}])=3'
              name: 'VMware: The {$VMWARE.HV.UUID} health is Red'
              priority: HIGH
              description: 'One or more components in the appliance might be in an unusable status and the appliance might become unresponsive soon. Security patches might be available.'
              tags:
                - tag: scope
                  value: availability
                - tag: scope
                  value: performance
            - uuid: ef6ca4d7033c4c8cb963eb7d493b3c7b
              expression: 'last(/VMware Hypervisor/vmware.hv.status[{$VMWARE.URL},{$VMWARE.HV.UUID}])=2'
              name: 'VMware: The {$VMWARE.HV.UUID} health is Yellow'
              priority: AVERAGE
              description: 'One or more components in the appliance might become overloaded soon.'
              dependencies:
                - name: 'VMware: The {$VMWARE.HV.UUID} health is Red'
                  expression: 'last(/VMware Hypervisor/vmware.hv.status[{$VMWARE.URL},{$VMWARE.HV.UUID}])=3'
              tags:
                - tag: scope
                  value: availability
                - tag: scope
                  value: performance
        - uuid: ecad96137494476293b57a0440de3f65
          name: 'VMware: Uptime'
          type: SIMPLE
          key: 'vmware.hv.uptime[{$VMWARE.URL},{$VMWARE.HV.UUID}]'
          history: 7d
          units: uptime
          username: '{$VMWARE.USERNAME}'
          password: '{$VMWARE.PASSWORD}'
          description: 'System uptime.'
          tags:
            - tag: component
              value: system
          triggers:
            - uuid: 01d316b0a8cf4998b344f0c4ef1daa32
              expression: 'last(/VMware Hypervisor/vmware.hv.uptime[{$VMWARE.URL},{$VMWARE.HV.UUID}])<10m'
              name: 'VMware: Hypervisor has been restarted'
              event_name: 'VMware: Hypervisor has been restarted (uptime < 10m)'
              priority: WARNING
              description: 'Uptime is less than 10 minutes.'
              manual_close: 'YES'
              tags:
                - tag: scope
                  value: notice
        - uuid: 222ad20887cf479b8e81a4c338078d17
          name: 'VMware: Version'
          type: SIMPLE
          key: 'vmware.hv.version[{$VMWARE.URL},{$VMWARE.HV.UUID}]'
          delay: 1h
          history: 7d
          trends: '0'
          value_type: CHAR
          username: '{$VMWARE.USERNAME}'
          password: '{$VMWARE.PASSWORD}'
          description: 'Dot-separated version string.'
          tags:
            - tag: component
              value: system
        - uuid: 2045df572e864834bd4bd97046353f4e
          name: 'VMware: Number of guest VMs'
          type: SIMPLE
          key: 'vmware.hv.vm.num[{$VMWARE.URL},{$VMWARE.HV.UUID}]'
          delay: 1h
          history: 7d
          username: '{$VMWARE.USERNAME}'
          password: '{$VMWARE.PASSWORD}'
          description: 'Number of guest virtual machines.'
          tags:
            - tag: component
              value: system
      discovery_rules:
        - uuid: fb7774df87994355baff7402d9fabcc2
          name: 'Datastore discovery'
          type: SIMPLE
          key: 'vmware.hv.datastore.discovery[{$VMWARE.URL},{$VMWARE.HV.UUID}]'
          delay: 1h
          username: '{$VMWARE.USERNAME}'
          password: '{$VMWARE.PASSWORD}'
          item_prototypes:
            - uuid: 65e6c165c3674953b2845d4101a9a6bf
              name: 'VMware: Multipath count for datastore {#DATASTORE}'
              type: SIMPLE
              key: 'vmware.hv.datastore.multipath[{$VMWARE.URL},{$VMWARE.HV.UUID},{#DATASTORE}]'
              history: 7d
              username: '{$VMWARE.USERNAME}'
              password: '{$VMWARE.PASSWORD}'
              description: 'Number of available datastore paths.'
              tags:
                - tag: component
                  value: datastore
                - tag: datastore
                  value: '{#DATASTORE}'
              trigger_prototypes:
                - uuid: 8f1de4827ba446ef902ca5fa44109c6d
                  expression: 'last(/VMware Hypervisor/vmware.hv.datastore.multipath[{$VMWARE.URL},{$VMWARE.HV.UUID},{#DATASTORE}],#1)<>last(/VMware Hypervisor/vmware.hv.datastore.multipath[{$VMWARE.URL},{$VMWARE.HV.UUID},{#DATASTORE}],#2) and last(/VMware Hypervisor/vmware.hv.datastore.multipath[{$VMWARE.URL},{$VMWARE.HV.UUID},{#DATASTORE}])<{#MULTIPATH.COUNT}'
                  name: 'VMware: The multipath count has been changed'
                  opdata: 'Current: {ITEM.LASTVALUE}, Registered: {#MULTIPATH.COUNT}'
                  priority: AVERAGE
                  description: 'The number of available datastore paths less than registered ({#MULTIPATH.COUNT}).'
                  manual_close: 'YES'
                  tags:
                    - tag: scope
                      value: notice
            - uuid: 259d1ff4bde143248f7ee2f7f880cb62
              name: 'VMware: Average read latency of the datastore {#DATASTORE}'
              type: SIMPLE
              key: 'vmware.hv.datastore.read[{$VMWARE.URL},{$VMWARE.HV.UUID},{#DATASTORE},latency]'
              history: 7d
              username: '{$VMWARE.USERNAME}'
              password: '{$VMWARE.PASSWORD}'
              description: 'Average amount of time for a read operation from the datastore (milliseconds).'
              tags:
                - tag: component
                  value: datastore
                - tag: datastore
                  value: '{#DATASTORE}'
            - uuid: f36245398cc4460a9cb4ec741612693b
              name: 'VMware: Free space on datastore {#DATASTORE} (percentage)'
              type: SIMPLE
              key: 'vmware.hv.datastore.size[{$VMWARE.URL},{$VMWARE.HV.UUID},{#DATASTORE},pfree]'
              delay: 5m
              history: 7d
              value_type: FLOAT
              units: '%'
              username: '{$VMWARE.USERNAME}'
              password: '{$VMWARE.PASSWORD}'
              description: 'VMware datastore free space in percentage from total.'
              tags:
                - tag: component
                  value: datastore
                - tag: datastore
                  value: '{#DATASTORE}'
              trigger_prototypes:
                - uuid: 79c83ed72685487a9ef139c42eea1106
                  expression: 'last(/VMware Hypervisor/vmware.hv.datastore.size[{$VMWARE.URL},{$VMWARE.HV.UUID},{#DATASTORE},pfree])<{$VMWARE.HV.DATASTORE.SPACE.CRIT}'
                  name: 'VMware: {#DATASTORE}: Free space is critically low'
                  event_name: 'Datastore free space is critically low ({#DATASTORE} free space < {$VMWARE.HV.DATASTORE.SPACE.CRIT}%)'
                  priority: HIGH
                  description: 'Datastore free space has fallen below critical threshold.'
                  tags:
                    - tag: scope
                      value: capacity
                - uuid: 5bc64ee899444a01a5bc315290256cdf
                  expression: 'last(/VMware Hypervisor/vmware.hv.datastore.size[{$VMWARE.URL},{$VMWARE.HV.UUID},{#DATASTORE},pfree])<{$VMWARE.HV.DATASTORE.SPACE.WARN}'
                  name: 'VMware: {#DATASTORE}: Free space is low'
                  event_name: 'Datastore free space is low ({#DATASTORE} free space < {$VMWARE.HV.DATASTORE.SPACE.WARN}%)'
                  priority: WARNING
                  description: 'Datastore free space has fallen below warning threshold.'
                  dependencies:
                    - name: 'VMware: {#DATASTORE}: Free space is critically low'
                      expression: 'last(/VMware Hypervisor/vmware.hv.datastore.size[{$VMWARE.URL},{$VMWARE.HV.UUID},{#DATASTORE},pfree])<{$VMWARE.HV.DATASTORE.SPACE.CRIT}'
                  tags:
                    - tag: scope
                      value: capacity
            - uuid: cc83e8f5ec08483db75482706bf01aba
              name: 'VMware: Total size of datastore {#DATASTORE}'
              type: SIMPLE
              key: 'vmware.hv.datastore.size[{$VMWARE.URL},{$VMWARE.HV.UUID},{#DATASTORE}]'
              delay: 5m
              history: 7d
              units: B
              username: '{$VMWARE.USERNAME}'
              password: '{$VMWARE.PASSWORD}'
              description: 'VMware datastore space in bytes.'
              tags:
                - tag: component
                  value: datastore
                - tag: datastore
                  value: '{#DATASTORE}'
            - uuid: 9db980d8f5f44af5ad11a5949d80031d
              name: 'VMware: Average write latency of the datastore {#DATASTORE}'
              type: SIMPLE
              key: 'vmware.hv.datastore.write[{$VMWARE.URL},{$VMWARE.HV.UUID},{#DATASTORE},latency]'
              history: 7d
              username: '{$VMWARE.USERNAME}'
              password: '{$VMWARE.PASSWORD}'
              description: 'Average amount of time for a write operation to the datastore (milliseconds).'
              tags:
                - tag: component
                  value: datastore
                - tag: datastore
                  value: '{#DATASTORE}'
        - uuid: deb31adf69634837839e2d8f87167f28
          name: 'Healthcheck discovery'
          type: DEPENDENT
          key: vmware.hv.healthcheck.discovery
          delay: '0'
          description: 'VMware Rollup Health State sensor discovery.'
          item_prototypes:
            - uuid: fabb7524dd454daa942266e5565ce40e
              name: 'VMware: Health state rollup'
              type: DEPENDENT
              key: 'vmware.hv.sensor.health.state[{#SINGLETON}]'
              delay: '0'
              history: 7d
              trends: '0'
              value_type: CHAR
              description: 'The host health state rollup sensor value: gray - unknown, green - ok, red - it has a problem, yellow - it might have a problem.'
              preprocessing:
                - type: JSONPATH
                  parameters:
                    - '$..HostNumericSensorInfo[?(@.name=="VMware Rollup Health State")].healthState.label.first()'
              master_item:
                key: 'vmware.hv.sensors.get[{$VMWARE.URL},{$VMWARE.HV.UUID}]'
              tags:
                - tag: component
                  value: health
              trigger_prototypes:
                - uuid: 9f2a65161946436986aacf6c9a637673
                  expression: 'last(/VMware Hypervisor/vmware.hv.sensor.health.state[{#SINGLETON}])="Red"'
                  name: 'VMware: The {$VMWARE.HV.UUID} health is Red'
                  priority: HIGH
                  description: 'One or more components in the appliance might be in an unusable status and the appliance might become unresponsive soon. Security patches might be available.'
                  dependencies:
                    - name: 'VMware: The {$VMWARE.HV.UUID} health is Red'
                      expression: 'last(/VMware Hypervisor/vmware.hv.status[{$VMWARE.URL},{$VMWARE.HV.UUID}])=3'
                  tags:
                    - tag: scope
                      value: availability
                    - tag: scope
                      value: performance
                - uuid: dc4f84eb8d2143bb80999fbc58f38928
                  expression: 'last(/VMware Hypervisor/vmware.hv.sensor.health.state[{#SINGLETON}])="Yellow"'
                  name: 'VMware: The {$VMWARE.HV.UUID} health is Yellow'
                  priority: AVERAGE
                  description: 'One or more components in the appliance might become overloaded soon.'
                  dependencies:
                    - name: 'VMware: The {$VMWARE.HV.UUID} health is Red'
                      expression: 'last(/VMware Hypervisor/vmware.hv.sensor.health.state[{#SINGLETON}])="Red"'
                    - name: 'VMware: The {$VMWARE.HV.UUID} health is Red'
                      expression: 'last(/VMware Hypervisor/vmware.hv.status[{$VMWARE.URL},{$VMWARE.HV.UUID}])=3'
                    - name: 'VMware: The {$VMWARE.HV.UUID} health is Yellow'
                      expression: 'last(/VMware Hypervisor/vmware.hv.status[{$VMWARE.URL},{$VMWARE.HV.UUID}])=2'
                  tags:
                    - tag: scope
                      value: availability
                    - tag: scope
                      value: performance
          master_item:
            key: 'vmware.hv.sensors.get[{$VMWARE.URL},{$VMWARE.HV.UUID}]'
          preprocessing:
            - type: JSONPATH
              parameters:
                - '$..HostNumericSensorInfo[?(@.name=="VMware Rollup Health State")]'
              error_handler: CUSTOM_VALUE
              error_handler_params: '[]'
            - type: JAVASCRIPT
              parameters:
                - 'return JSON.stringify(value != "[]" ? [{''{#SINGLETON}'': ''''}] : []);'
            - type: DISCARD_UNCHANGED_HEARTBEAT
              parameters:
                - 6h
        - uuid: ace5c21254804024a6571a5d030383a0
          name: 'Sensor discovery'
          type: DEPENDENT
          key: vmware.hv.sensors.discovery
          delay: '0'
          filter:
            evaltype: AND
            conditions:
              - macro: '{#NAME}'
                value: 'VMware Rollup Health State'
                operator: NOT_MATCHES_REGEX
                formulaid: A
              - macro: '{#NAME}'
                value: '{$VMWARE.HV.SENSOR.DISCOVERY.NAME.MATCHES}'
                formulaid: B
              - macro: '{#NAME}'
                value: '{$VMWARE.HV.SENSOR.DISCOVERY.NAME.NOT_MATCHES}'
                operator: NOT_MATCHES_REGEX
                formulaid: C
          description: 'VMware hardware sensor discovery. The data is retrieved from numeric sensor probes and provides information about the health of the physical system.'
          item_prototypes:
            - uuid: d9a7725ccb0647069b331c5e3e51aeaf
              name: 'VMware: Sensor [{#NAME}] health state'
              type: DEPENDENT
              key: 'vmware.hv.sensor.state["{#NAME}"]'
              delay: '0'
              history: 7d
              description: |
                VMware hardware sensor health state. One of the following:
                - Unknown
                - Green
                - Yellow
                - Red
              valuemap:
                name: 'Sensor health status'
              preprocessing:
                - type: JSONPATH
                  parameters:
                    - '$..HostNumericSensorInfo[?(@.name=="{#NAME}")].healthState.label.first()'
                - type: JAVASCRIPT
                  parameters:
                    - |
                      const idx = [
                        'unknown',
                        'green',
                        'yellow',
                        'red',
                      ].indexOf(value.toLowerCase());
                      return idx !== -1 ? idx : 0;
                - type: DISCARD_UNCHANGED_HEARTBEAT
                  parameters:
                    - 6h
              master_item:
                key: 'vmware.hv.sensors.get[{$VMWARE.URL},{$VMWARE.HV.UUID}]'
              tags:
                - tag: component
                  value: health
                - tag: component
                  value: sensor
                - tag: type
                  value: '{#TYPE}'
              trigger_prototypes:
                - uuid: f591aa480fb94996be8225176bc9c95c
                  expression: 'last(/VMware Hypervisor/vmware.hv.sensor.state["{#NAME}"])=3'
                  name: 'VMware: Sensor [{#NAME}] health state is Red'
                  priority: HIGH
                  description: 'One or more components in the appliance might be in an unusable status and the appliance might become unresponsive soon.'
                  dependencies:
                    - name: 'VMware: The {$VMWARE.HV.UUID} health is Red'
                      expression: 'last(/VMware Hypervisor/vmware.hv.status[{$VMWARE.URL},{$VMWARE.HV.UUID}])=3'
                  tags:
                    - tag: scope
                      value: availability
                    - tag: scope
                      value: performance
                - uuid: c49e1b853f07417abb3812fd03da0bc3
                  expression: 'last(/VMware Hypervisor/vmware.hv.sensor.state["{#NAME}"])=2'
                  name: 'VMware: Sensor [{#NAME}] health state is Yellow'
                  priority: AVERAGE
                  description: 'One or more components in the appliance might become overloaded soon.'
                  dependencies:
                    - name: 'VMware: Sensor [{#NAME}] health state is Red'
                      expression: 'last(/VMware Hypervisor/vmware.hv.sensor.state["{#NAME}"])=3'
                    - name: 'VMware: The {$VMWARE.HV.UUID} health is Red'
                      expression: 'last(/VMware Hypervisor/vmware.hv.status[{$VMWARE.URL},{$VMWARE.HV.UUID}])=3'
                    - name: 'VMware: The {$VMWARE.HV.UUID} health is Yellow'
                      expression: 'last(/VMware Hypervisor/vmware.hv.status[{$VMWARE.URL},{$VMWARE.HV.UUID}])=2'
                  tags:
                    - tag: scope
                      value: availability
                    - tag: scope
                      value: performance
          master_item:
            key: 'vmware.hv.sensors.get[{$VMWARE.URL},{$VMWARE.HV.UUID}]'
          preprocessing:
            - type: JAVASCRIPT
              parameters:
                - |
                  var result = [],
                      sensors = JSON.parse(value)['val']['HostNumericSensorInfo'],
                      discovery_flag = '{$VMWARE.HV.SENSOR.DISCOVERY}'.toLowerCase().trim();
                  
                  if (!(discovery_flag == 'true' || discovery_flag == 'false')) {
                      throw 'Incorrect value of macro "{$' + 'VMWARE.HV.SENSOR.DISCOVERY}". Can be used only "true" or "false". Actual value: ' + discovery_flag;
                  }
                  
                  if (discovery_flag !== 'true' || typeof sensors === "undefined") {
                      return JSON.stringify([]);
                  }
                  
                  sensors.forEach(function(sensor) {
                      result.push({"{#NAME}": sensor['name'], "{#TYPE}": sensor['sensorType'].toLowerCase()});
                  })
                  
                  return JSON.stringify(result);
            - type: DISCARD_UNCHANGED_HEARTBEAT
              parameters:
                - 6h
      tags:
        - tag: class
          value: software
        - tag: target
          value: vmware
        - tag: target
          value: vmware-hypervisor
      macros:
        - macro: '{$VMWARE.HV.DATASTORE.SPACE.CRIT}'
          value: '10'
          description: 'The critical threshold of the datastore free space.'
        - macro: '{$VMWARE.HV.DATASTORE.SPACE.WARN}'
          value: '20'
          description: 'The warning threshold of the datastore free space.'
        - macro: '{$VMWARE.HV.SENSOR.DISCOVERY}'
          value: 'false'
          description: 'Set "true"/"false" to enable or disable monitoring of hardware sensors.'
        - macro: '{$VMWARE.HV.SENSOR.DISCOVERY.NAME.MATCHES}'
          value: '.*'
          description: 'Sets the regex string of hardware sensor names to allow in discovery.'
        - macro: '{$VMWARE.HV.SENSOR.DISCOVERY.NAME.NOT_MATCHES}'
          value: CHANGE_IF_NEEDED
          description: 'Sets the regex string of hardware sensor names to ignore in discovery.'
        - macro: '{$VMWARE.PASSWORD}'
          description: 'VMware service {$USERNAME} user password.'
        - macro: '{$VMWARE.URL}'
          description: 'VMware service (vCenter or ESX hypervisor) SDK URL (https://servername/sdk).'
        - macro: '{$VMWARE.USERNAME}'
          description: 'VMware service user name.'
      valuemaps:
        - uuid: 1a236bcb5a064d4e9a3572c086187ab8
          name: 'Sensor health status'
          mappings:
            - value: '0'
              newvalue: Unknown
            - value: '1'
              newvalue: Green
            - value: '2'
              newvalue: Yellow
            - value: '3'
              newvalue: Red
        - uuid: 25d04e2838af4fcca9ddd21df6781497
          name: 'Service state'
          mappings:
            - value: '0'
              newvalue: Down
            - value: '1'
              newvalue: Up
        - uuid: 2b324fd8d7624874a3a81449b62c2cd6
          name: 'VMware status'
          mappings:
            - value: '0'
              newvalue: gray
            - value: '1'
              newvalue: green
            - value: '2'
              newvalue: yellow
            - value: '3'
              newvalue: red
